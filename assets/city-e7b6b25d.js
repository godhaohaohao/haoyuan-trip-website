import{c as ee,m as q,n as F,t as be,h as ie,e as te,r as Ue,d as ne,u as Ge,a as l,x as K,I as Q,w as ae,aF as ye,ax as Se,a2 as Ye,aG as Xe,aH as Je,U as Qe,a0 as we,q as M,Q as Te,aI as Ze,b as p,f as et,E as tt,k as ue,A as J,C as Ve,s as de,aJ as xe,aK as nt,p as le,aL as at,K as Ee,aM as ot,aN as it,ar as lt,S as ct,F as rt,_ as st,as as ut,aa as fe,a6 as ge,v as dt,aO as ft,X as ke,ab as Re,am as Ae,ac as R,ad as z,aP as Le,ag as he,G,aj as Z,ak as gt,aq as me,al as ve,ai as ht,y as mt,z as vt}from"./index-58d6d92f.js";import{b as $e,u as Pe,a as bt,T as yt}from"./city-aff29980.js";import{a as ce,u as _t}from"./axios-01b679f0.js";const[xt,U]=ee("cell"),Be={tag:q("div"),icon:String,size:String,title:F,value:F,label:F,center:Boolean,isLink:Boolean,border:be,required:Boolean,iconPrefix:String,valueClass:ie,labelClass:ie,titleClass:ie,titleStyle:null,arrowDirection:String,clickable:{type:Boolean,default:null}},kt=te({},Be,Ue);var Ct=ne({name:xt,props:kt,setup(e,{slots:n}){const a=Ge(),u=()=>{if(n.label||K(e.label))return l("div",{class:[U("label"),e.labelClass]},[n.label?n.label():e.label])},i=()=>{var o;if(n.title||K(e.title)){const h=(o=n.title)==null?void 0:o.call(n);return Array.isArray(h)&&h.length===0?void 0:l("div",{class:[U("title"),e.titleClass],style:e.titleStyle},[h||l("span",null,[e.title]),u()])}},r=()=>{const o=n.value||n.default;if(o||K(e.value))return l("div",{class:[U("value"),e.valueClass]},[o?o():l("span",null,[e.value])])},m=()=>{if(n.icon)return n.icon();if(e.icon)return l(Q,{name:e.icon,class:U("left-icon"),classPrefix:e.iconPrefix},null)},v=()=>{if(n["right-icon"])return n["right-icon"]();if(e.isLink){const o=e.arrowDirection&&e.arrowDirection!=="right"?`arrow-${e.arrowDirection}`:"arrow";return l(Q,{name:o,class:U("right-icon")},null)}};return()=>{var o;const{tag:h,size:s,center:k,border:b,isLink:_,required:S}=e,V=(o=e.clickable)!=null?o:_,L={center:k,required:S,clickable:V,borderless:!b};return s&&(L[s]=!!s),l(h,{class:U(L),role:V?"button":void 0,tabindex:V?0:void 0,onClick:a},{default:()=>{var $;return[m(),i(),r(),v(),($=n.extra)==null?void 0:$.call(n)]}})}}});const pe=ae(Ct);function Me(e){return Array.isArray(e)?!e.length:e===0?!1:!e}function It(e,n){if(Me(e)){if(n.required)return!1;if(n.validateEmpty===!1)return!0}return!(n.pattern&&!n.pattern.test(String(e)))}function St(e,n){return new Promise(a=>{const u=n.validator(e,n);if(Xe(u)){u.then(a);return}a(u)})}function Ce(e,n){const{message:a}=n;return Je(a)?a(e,n):a||""}function wt({target:e}){e.composing=!0}function Ie({target:e}){e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}function Tt(e,n){const a=ye();e.style.height="auto";let u=e.scrollHeight;if(Ye(n)){const{maxHeight:i,minHeight:r}=n;i!==void 0&&(u=Math.min(u,i)),r!==void 0&&(u=Math.max(u,r))}u&&(e.style.height=`${u}px`,Se(a))}function Vt(e){return e==="number"?{type:"text",inputmode:"decimal"}:e==="digit"?{type:"tel",inputmode:"numeric"}:{type:e}}function re(e){return[...e].length}function Et(e,n){return[...e].slice(0,n).join("")}const[Rt,E]=ee("field"),_e={id:String,name:String,leftIcon:String,rightIcon:String,autofocus:Boolean,clearable:Boolean,maxlength:F,formatter:Function,clearIcon:q("clear"),modelValue:Qe(""),inputAlign:String,placeholder:String,autocomplete:String,errorMessage:String,enterkeyhint:String,clearTrigger:q("focus"),formatTrigger:q("onChange"),error:{type:Boolean,default:null},disabled:{type:Boolean,default:null},readonly:{type:Boolean,default:null}},At=te({},Be,_e,{rows:F,type:q("text"),rules:Array,autosize:[Boolean,Object],labelWidth:F,labelClass:ie,labelAlign:String,showWordLimit:Boolean,errorMessageAlign:String,colon:{type:Boolean,default:null}});var Lt=ne({name:Rt,props:At,emits:["blur","focus","clear","keypress","clickInput","endValidate","startValidate","clickLeftIcon","clickRightIcon","update:modelValue"],setup(e,{emit:n,slots:a}){const u=$e(),i=we({status:"unvalidated",focused:!1,validateMessage:""}),r=M(),m=M(),v=M(),{parent:o}=Te(Ze),h=()=>{var t;return String((t=e.modelValue)!=null?t:"")},s=t=>{if(K(e[t]))return e[t];if(o&&K(o.props[t]))return o.props[t]},k=p(()=>{const t=s("readonly");if(e.clearable&&!t){const d=h()!=="",g=e.clearTrigger==="always"||e.clearTrigger==="focus"&&i.focused;return d&&g}return!1}),b=p(()=>v.value&&a.input?v.value():e.modelValue),_=t=>t.reduce((d,g)=>d.then(()=>{if(i.status==="failed")return;let{value:T}=b;if(g.formatter&&(T=g.formatter(T,g)),!It(T,g)){i.status="failed",i.validateMessage=Ce(T,g);return}if(g.validator)return Me(T)&&g.validateEmpty===!1?void 0:St(T,g).then(I=>{I&&typeof I=="string"?(i.status="failed",i.validateMessage=I):I===!1&&(i.status="failed",i.validateMessage=Ce(T,g))})}),Promise.resolve()),S=()=>{i.status="unvalidated",i.validateMessage=""},V=()=>n("endValidate",{status:i.status,message:i.validateMessage}),L=(t=e.rules)=>new Promise(d=>{S(),t?(n("startValidate"),_(t).then(()=>{i.status==="failed"?(d({name:e.name,message:i.validateMessage}),V()):(i.status="passed",d(),V())})):d()}),$=t=>{if(o&&e.rules){const{validateTrigger:d}=o.props,g=xe(d).includes(t),T=e.rules.filter(I=>I.trigger?xe(I.trigger).includes(t):g);T.length&&L(T)}},H=t=>{const{maxlength:d}=e;if(K(d)&&re(t)>d){const g=h();return g&&re(g)===+d?g:Et(t,+d)}return t},O=(t,d="onChange")=>{const g=t;t=H(t);const T=t!==g;if(e.type==="number"||e.type==="digit"){const I=e.type==="number";t=nt(t,I,I)}if(e.formatter&&d===e.formatTrigger&&(t=e.formatter(t)),r.value&&r.value.value!==t)if(i.focused&&T){const{selectionStart:I,selectionEnd:We}=r.value;r.value.value=t,r.value.setSelectionRange(I-1,We-1)}else r.value.value=t;t!==e.modelValue&&n("update:modelValue",t)},Y=t=>{t.target.composing||O(t.target.value)},c=()=>{var t;return(t=r.value)==null?void 0:t.blur()},W=()=>{var t;return(t=r.value)==null?void 0:t.focus()},D=()=>{const t=r.value;e.type==="textarea"&&e.autosize&&t&&Tt(t,e.autosize)},f=t=>{i.focused=!0,n("focus",t),J(D),s("readonly")&&c()},y=t=>{s("readonly")||(i.focused=!1,O(h(),"onBlur"),n("blur",t),$("onBlur"),J(D),it())},x=t=>n("clickInput",t),w=t=>n("clickLeftIcon",t),C=t=>n("clickRightIcon",t),P=t=>{le(t),n("update:modelValue",""),n("clear",t)},N=p(()=>{if(typeof e.error=="boolean")return e.error;if(o&&o.props.showError&&i.status==="failed")return!0}),B=p(()=>{const t=s("labelWidth");if(t)return{width:et(t)}}),A=t=>{t.keyCode===13&&(!(o&&o.props.submitOnEnter)&&e.type!=="textarea"&&le(t),e.type==="search"&&c()),n("keypress",t)},oe=()=>e.id||`${u}-input`,j=()=>i.status,Ne=()=>{const t=E("control",[s("inputAlign"),{error:N.value,custom:!!a.input,"min-height":e.type==="textarea"&&!e.autosize}]);if(a.input)return l("div",{class:t,onClick:x},[a.input()]);const d={id:oe(),ref:r,name:e.name,rows:e.rows!==void 0?+e.rows:void 0,class:t,disabled:s("disabled"),readonly:s("readonly"),autofocus:e.autofocus,placeholder:e.placeholder,autocomplete:e.autocomplete,enterkeyhint:e.enterkeyhint,"aria-labelledby":e.label?`${u}-label`:void 0,onBlur:y,onFocus:f,onInput:Y,onClick:x,onChange:Ie,onKeypress:A,onCompositionend:Ie,onCompositionstart:wt};return e.type==="textarea"?l("textarea",d,null):l("input",Ee(Vt(e.type),d),null)},ze=()=>{const t=a["left-icon"];if(e.leftIcon||t)return l("div",{class:E("left-icon"),onClick:w},[t?t():l(Q,{name:e.leftIcon,classPrefix:e.iconPrefix},null)])},Fe=()=>{const t=a["right-icon"];if(e.rightIcon||t)return l("div",{class:E("right-icon"),onClick:C},[t?t():l(Q,{name:e.rightIcon,classPrefix:e.iconPrefix},null)])},je=()=>{if(e.showWordLimit&&e.maxlength){const t=re(h());return l("div",{class:E("word-limit")},[l("span",{class:E("word-num")},[t]),ot("/"),e.maxlength])}},qe=()=>{if(o&&o.props.showErrorMessage===!1)return;const t=e.errorMessage||i.validateMessage;if(t){const d=a["error-message"],g=s("errorMessageAlign");return l("div",{class:E("error-message",g)},[d?d({message:t}):t])}},Ke=()=>{const t=s("colon")?":":"";if(a.label)return[a.label(),t];if(e.label)return l("label",{id:`${u}-label`,for:oe()},[e.label+t])},He=()=>[l("div",{class:E("body")},[Ne(),k.value&&l(Q,{ref:m,name:e.clearIcon,class:E("clear")},null),Fe(),a.button&&l("div",{class:E("button")},[a.button()])]),je(),qe()];return ce({blur:c,focus:W,validate:L,formValue:b,resetValidation:S,getValidationStatus:j}),tt(at,{customValue:v,resetValidation:S,validateWithTrigger:$}),ue(()=>e.modelValue,()=>{O(h()),S(),$("onChange"),J(D)}),Ve(()=>{O(h(),e.formatTrigger),J(D)}),de("touchstart",P,{target:p(()=>{var t;return(t=m.value)==null?void 0:t.$el})}),()=>{const t=s("disabled"),d=s("labelAlign"),g=ze(),T=()=>{const I=Ke();return d==="top"?[g,I].filter(Boolean):I||[]};return l(pe,{size:e.size,class:E({error:N.value,disabled:t,[`label-${d}`]:d}),center:e.center,border:e.border,isLink:e.isLink,clickable:e.clickable,titleStyle:B.value,valueClass:E("value"),titleClass:[E("label",[d,{required:e.required}]),e.labelClass],arrowDirection:e.arrowDirection},{icon:g&&d!=="top"?()=>g:null,title:T,value:He,extra:a.extra})}}});const $t=ae(Lt);function Pt(){const e="A".charCodeAt(0);return Array(26).fill("").map((a,u)=>String.fromCharCode(e+u))}const[Oe,se]=ee("index-bar"),Bt={sticky:be,zIndex:F,teleport:[String,Object],highlightColor:String,stickyOffsetTop:st(0),indexList:{type:Array,default:Pt}},De=Symbol(Oe);var pt=ne({name:Oe,props:Bt,emits:["select","change"],setup(e,{emit:n,slots:a}){const u=M(),i=M(),r=M(""),m=_t(),v=lt(u),{children:o,linkChildren:h}=ct(De);let s;h({props:e});const k=p(()=>{if(K(e.zIndex))return{zIndex:+e.zIndex+1}}),b=p(()=>{if(e.highlightColor)return{color:e.highlightColor}}),_=(f,y)=>{for(let x=o.length-1;x>=0;x--){const w=x>0?y[x-1].height:0,C=e.sticky?w+e.stickyOffsetTop:0;if(f+C>=y[x].top)return x}return-1},S=f=>o.find(y=>String(y.index)===f),V=()=>{if(ut(u))return;const{sticky:f,indexList:y}=e,x=fe(v.value),w=ge(v),C=o.map(N=>N.getRect(v.value,w));let P=-1;if(s){const N=S(s);if(N){const B=N.getRect(v.value,w);P=_(B.top,C)}}else P=_(x,C);r.value=y[P],f&&o.forEach((N,B)=>{const{state:A,$el:oe}=N;if(B===P||B===P-1){const j=oe.getBoundingClientRect();A.left=j.left,A.width=j.width}else A.left=null,A.width=null;if(B===P)A.active=!0,A.top=Math.max(e.stickyOffsetTop,C[B].top-x)+w.top;else if(B===P-1&&s===""){const j=C[P].top-x;A.active=j>0,A.top=j+w.top-C[B].height}else A.active=!1}),s=""},L=()=>{J(V)};de("scroll",V,{target:v,passive:!0}),Ve(L),ue(()=>e.indexList,L),ue(r,f=>{f&&n("change",f)});const $=()=>e.indexList.map(f=>{const y=f===r.value;return l("span",{class:se("index",{active:y}),style:y?b.value:void 0,"data-index":f},[f])}),H=f=>{s=String(f);const y=S(s);if(y){const x=fe(v.value),w=ge(v),{offsetHeight:C}=document.documentElement;if(y.$el.scrollIntoView(),x===C-w.height){V();return}e.sticky&&e.stickyOffsetTop&&Se(ye()-e.stickyOffsetTop),n("select",y.index)}},O=f=>{const{index:y}=f.dataset;y&&H(y)},Y=f=>{O(f.target)};let c;const W=f=>{if(m.move(f),m.isVertical()){le(f);const{clientX:y,clientY:x}=f.touches[0],w=document.elementFromPoint(y,x);if(w){const{index:C}=w.dataset;C&&c!==C&&(c=C,O(w))}}},D=()=>l("div",{ref:i,class:se("sidebar"),style:k.value,onClick:Y,onTouchstartPassive:m.start},[$()]);return ce({scrollTo:H}),de("touchmove",W,{target:i}),()=>{var f;return l("div",{ref:u,class:se()},[e.teleport?l(rt,{to:e.teleport},{default:()=>[D()]}):D(),(f=a.default)==null?void 0:f.call(a)])}}});const[Mt,Ot]=ee("index-anchor"),Dt={index:F};var Nt=ne({name:Mt,props:Dt,setup(e,{slots:n}){const a=we({top:0,left:null,rect:{top:0,height:0},width:null,active:!1}),u=M(),{parent:i}=Te(De);if(!i)return;const r=()=>a.active&&i.props.sticky,m=p(()=>{const{zIndex:o,highlightColor:h}=i.props;if(r())return te(dt(o),{left:a.left?`${a.left}px`:void 0,width:a.width?`${a.width}px`:void 0,transform:a.top?`translate3d(0, ${a.top}px, 0)`:void 0,color:h})});return ce({state:a,getRect:(o,h)=>{const s=ge(u);return a.rect.height=s.height,o===window||o===document.body?a.rect.top=s.top+ye():a.rect.top=s.top+fe(o)-h.top,a.rect}}),()=>{const o=r();return l("div",{ref:u,style:{height:o?`${a.rect.height}px`:void 0}},[l("div",{style:m.value,class:[Ot({sticky:o}),{[ft]:o}]},[n.default?n.default():e.index])])}}});const zt=ae(Nt),Ft=ae(pt),[jt,X,qt]=ee("search"),Kt=te({},_e,{label:String,shape:q("square"),leftIcon:q("search"),clearable:be,actionText:String,background:String,showAction:Boolean});var Ht=ne({name:jt,props:Kt,emits:["blur","focus","clear","search","cancel","clickInput","clickLeftIcon","clickRightIcon","update:modelValue"],setup(e,{emit:n,slots:a,attrs:u}){const i=$e(),r=M(),m=()=>{a.action||(n("update:modelValue",""),n("cancel"))},v=c=>{c.keyCode===13&&(le(c),n("search",e.modelValue))},o=()=>e.id||`${i}-input`,h=()=>{if(a.label||e.label)return l("label",{class:X("label"),for:o()},[a.label?a.label():e.label])},s=()=>{if(e.showAction){const c=e.actionText||qt("cancel");return l("div",{class:X("action"),role:"button",tabindex:0,onClick:m},[a.action?a.action():c])}},k=()=>{var c;return(c=r.value)==null?void 0:c.blur()},b=()=>{var c;return(c=r.value)==null?void 0:c.focus()},_=c=>n("blur",c),S=c=>n("focus",c),V=c=>n("clear",c),L=c=>n("clickInput",c),$=c=>n("clickLeftIcon",c),H=c=>n("clickRightIcon",c),O=Object.keys(_e),Y=()=>{const c=te({},u,ke(e,O),{id:o()}),W=D=>n("update:modelValue",D);return l($t,Ee({ref:r,type:"search",class:X("field"),border:!1,onBlur:_,onFocus:S,onClear:V,onKeypress:v,onClickInput:L,onClickLeftIcon:$,onClickRightIcon:H,"onUpdate:modelValue":W},c),ke(a,["left-icon","right-icon"]))};return ce({focus:b,blur:k}),()=>{var c;return l("div",{class:X({"show-action":e.showAction}),style:{background:e.background}},[(c=a.left)==null?void 0:c.call(a),l("div",{class:X("content",e.shape)},[h(),Y()]),s()])}}});const Wt=ae(Ht);const Ut={class:"city-group"},Gt={class:"list"},Yt=["onClick"],Xt={__name:"city-group",props:{groupData:{type:Object,default:()=>({})}},setup(e){const n=e,a=p(()=>{const m=n.groupData.cities.map(v=>v.group);return m.unshift("#"),m}),u=Ae(),i=Pe(),r=m=>{i.currentCity=m,u.back()};return(m,v)=>{const o=zt,h=pe,s=Ft;return R(),z("div",Ut,[l(s,{sticky:!1,"highlight-color":"#ff9854","index-list":ve(a)},{default:Le(()=>[l(o,{index:"热门"}),he("div",Gt,[(R(!0),z(G,null,Z(e.groupData.hotCities,(k,b)=>(R(),z("div",{key:b,class:"city",onClick:_=>r(k)},gt(k.cityName),9,Yt))),128))]),(R(!0),z(G,null,Z(e.groupData.cities,(k,b)=>(R(),z(G,{key:b},[l(o,{index:k.group},null,8,["index"]),(R(!0),z(G,null,Z(k.cities,_=>(R(),me(h,{title:_.cityName,onClick:S=>r(_)},null,8,["title","onClick"]))),256))],64))),128))]),_:1},8,["index-list"])])}}},Jt=Re(Xt,[["__scopeId","data-v-406f77d1"]]);const Qt={class:"city topPage"},Zt={class:"top"},en={class:"content"},tn={__name:"city",setup(e){const n=Ae(),a=M(""),u=()=>{n.back()},i=M(),r=Pe();r.fetchAllCitiesData();const{allCities:m}=ht(r);return p(()=>m.value[i.value]),(v,o)=>{const h=Wt,s=bt,k=yt;return R(),z("div",Qt,[he("div",Zt,[l(h,{modelValue:a.value,"onUpdate:modelValue":o[0]||(o[0]=b=>a.value=b),shape:"round",placeholder:"城市/区域/位置","show-action":"",onCancel:u},null,8,["modelValue"]),l(k,{active:i.value,"onUpdate:active":o[1]||(o[1]=b=>i.value=b),color:"var(--hao-color)"},{default:Le(()=>[(R(!0),z(G,null,Z(ve(m),(b,_,S)=>(R(),me(s,{key:_,title:b.title,name:_},null,8,["title","name"]))),128))]),_:1},8,["active"])]),he("div",en,[(R(!0),z(G,null,Z(ve(m),(b,_,S)=>mt((R(),me(Jt,{"group-data":b},null,8,["group-data"])),[[vt,i.value===_]])),256))])])}}},ln=Re(tn,[["__scopeId","data-v-64059b12"]]);export{ln as default};
